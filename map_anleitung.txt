-- Chopped Straw
-- Spec for chopped straw left on field

#######################
Anleitung Teil 1 von 5:

Es müssen mehrere Einträge in die MAP.i3d eingefügt werden:
  - 6 File-Einträge
  - 5 Material-Einträge
  - 1 FoliageMultiLayer mit drei FoliageSubLayern
Diese Einträge befinden sich IN DIESER Datei und müssen noch angepasst werden.

Vor allen folgenden Arbeiten: erstelle eine Sicherheitskopie deiner Map, um bei Problemen zu einer funktionierenden Version zurückkehren zu können.
Die Map muss vorher entpackt werden.

A.  Zuerst müssen einige Zahlen in der MAP.i3d gesucht und notiert werden (die Suchfunktion des Texteditors soll hier Wunder wirken):

    A-1. Suche die 'fileId' von 'shaders/windrowFoliageShader.xml'. Notiere den Wert hier-> 80
    A-2. Suche die 'blockShapeId' in 'FoliageSubLayer name="potato_haulm"'. Notiere den Wert hier-> 34

B.  Mit den gefundenen Zahlen ersetzt man nun einige Platzhalter in DIESER DATEI (in der du gerade liest)! Dazu verwendet man die Funktion "Suchen/Ersetzen" des Texteditors.
    Hinweis: Es werden !!Platzhalter!! (inklusive der jeweils zwei Ausrufezeichen) mit einer einfachen Zahl, wie z.B. 43 (ohne irgendetwas sonst) ersetzt.

    B-1. Suche nach     !!WINDROWSHADERFILEID!!     und ersetze mit der Zahl aus A-1.
    B-2. Suche nach     !!HAULMBLOCKSHAPEID!!       und ersetze mit der Zahl aus A-2.


	#######################
Anleitung Teil 2 von 5:

Füge die folgenden sechs <File>-Einträge im <Files>-Bereich deiner MAP.i3d ein

    <!-- choppedStraw files -->
	<File fileId="99984" filename="choppedStraw_SDK/foliage_lightStraw_distance.png" relativePath="true"/>
	<File fileId="99985" filename="choppedStraw_SDK/foliage_darkStraw_distance.png" relativePath="true"/>
    <File fileId="99993" filename="choppedStraw_SDK/straw_haulm_density.png" relativePath="true"/>
    <File fileId="99994" filename="choppedStraw_SDK/foliage_maizeStraw_diffuse.png" relativePath="true"/>
    <File fileId="99995" filename="choppedStraw_SDK/foliage_darkStraw_diffuse.png" relativePath="true"/>
    <File fileId="99996" filename="choppedStraw_SDK/foliage_lightStraw_diffuse.png" relativePath="true"/>
	<File fileId="99997" filename="choppedStraw_SDK/foliage_soybeanStraw_diffuse.png" relativePath="true"/>
	<File fileId="99998" filename="choppedStraw_SDK/foliage_sunflowerStraw_diffuse.png" relativePath="true"/>


#######################
Anleitung Teil 3 von 5:

Füge die folgenden fünf <Material>-Einträge im <Materials>-Bereich deiner MAP.i3d ein

    <!-- choppedStraw materials -->
    <Material name="maizeStrawMaterial" materialId="99001" ambientColor="1 1 1" customShaderId="!!WINDROWSHADERFILEID!!">
      <Texture fileId="99994"/>
      <CustomParameter name="alphaBlendStartEnd" value="70 75 0 0"/>
	  <CustomParameter name="cellSizeTerrainSizeScaleXZScaleY" value="16 1024 2 255"/>
    </Material>
    <Material name="darkStrawMaterial" materialId="99002" ambientColor="1 1 1" customShaderId="!!WINDROWSHADERFILEID!!">
      <Texture fileId="99995"/>
      <CustomParameter name="alphaBlendStartEnd" value="70 75 0 0"/>
	  <CustomParameter name="cellSizeTerrainSizeScaleXZScaleY" value="16 1024 2 255"/>
    </Material>
    <Material name="lightStrawMaterial" materialId="99003" ambientColor="1 1 1" customShaderId="!!WINDROWSHADERFILEID!!">
      <Texture fileId="99996"/>
      <CustomParameter name="alphaBlendStartEnd" value="70 75 0 0"/>
	  <CustomParameter name="cellSizeTerrainSizeScaleXZScaleY" value="16 1024 2 255"/>
    </Material>
    <Material name="soybeanStrawMaterial" materialId="99004" ambientColor="1 1 1" customShaderId="!!WINDROWSHADERFILEID!!">
      <Texture fileId="99997"/>
      <CustomParameter name="alphaBlendStartEnd" value="70 75 0 0"/>
	  <CustomParameter name="cellSizeTerrainSizeScaleXZScaleY" value="16 1024 2 255"/>
    </Material>
    <Material name="sunflowerStrawMaterial" materialId="99005" ambientColor="1 1 1" customShaderId="!!WINDROWSHADERFILEID!!">
      <Texture fileId="99998"/>
      <CustomParameter name="alphaBlendStartEnd" value="70 75 0 0"/>
	  <CustomParameter name="cellSizeTerrainSizeScaleXZScaleY" value="16 1024 2 255"/>
    </Material>
	
	    <Material name="potatoHaulmMaterial" materialId="361" ambientColor="1 1 1" customShaderId="80">
      <Texture fileId="79"/>
      <CustomParameter name="alphaBlendStartEnd" value="70 75 0 0"/>
      <CustomParameter name="cellSizeTerrainSizeScaleXZScaleY" value="16 1024 2 255"/>
    </Material>


#######################
Anleitung Teil 4 von 5:

Füge den folgenden <FoliageMultiLayer>-Eintrag im <Layers>-Bereich deiner MAP.i3d ein, NACH <InfoLayer name="tipCol"...... />

    <!-- choppedStraw foliage layers -->
    <FoliageMultiLayer densityMapId="99993" numChannels="5" numTypeIndexChannels="0">
	  <FoliageSubLayer name="maizeStraw" densityMapChannelOffset="2" numDensityMapChannels="1" materialId="99001" distanceMapIds="99984" cellSize="8" viewDistance="80" objectMask="16711935"  distanceMapLayers="1" decalLayer="0" atlasSize="1"  atlasOffsets="1 0" numBlocksPerUnitDefault="1.2" numBlocksPerUnitMin="1.2" numBlocksPerUnitMax="1.2" width="1.5" height="0.5" widthVariance="0" heightVariance="0" horizontalPositionVariance="0.1" blockShapeId="!!HAULMBLOCKSHAPEID!!"/>
	  <FoliageSubLayer name="darkStraw" densityMapChannelOffset="1" numDensityMapChannels="1" materialId="99002" distanceMapIds="99985" cellSize="8" viewDistance="80" objectMask="16711935"  distanceMapLayers="1" decalLayer="0" atlasSize="1"  atlasOffsets="1 0" numBlocksPerUnitDefault="1.2" numBlocksPerUnitMin="1.2" numBlocksPerUnitMax="1.2" width="1.5" height="0.5" widthVariance="0" heightVariance="0" horizontalPositionVariance="0.1" blockShapeId="!!HAULMBLOCKSHAPEID!!"/>
	  <FoliageSubLayer name="lightStraw" densityMapChannelOffset="0" numDensityMapChannels="1" materialId="99003" distanceMapIds="99984" cellSize="8" viewDistance="80" objectMask="16711935"  distanceMapLayers="1" decalLayer="0" atlasSize="1"  atlasOffsets="1 0" numBlocksPerUnitDefault="1.2" numBlocksPerUnitMin="1.2" numBlocksPerUnitMax="1.2" width="1.5" height="0.5" widthVariance="0" heightVariance="0" horizontalPositionVariance="0.1" blockShapeId="!!HAULMBLOCKSHAPEID!!"/>
     <FoliageSubLayer name="soybeanStraw" densityMapChannelOffset="3" numDensityMapChannels="1" materialId="99004" distanceMapIds="99984" cellSize="8" viewDistance="80" objectMask="16711935"  distanceMapLayers="1" decalLayer="0" atlasSize="1"  atlasOffsets="1 0" numBlocksPerUnitDefault="1.2" numBlocksPerUnitMin="1.2" numBlocksPerUnitMax="1.2" width="1.5" height="0.5" widthVariance="0" heightVariance="0" horizontalPositionVariance="0.1" blockShapeId="!!HAULMBLOCKSHAPEID!!"/>
     <FoliageSubLayer name="sunflowerStraw" densityMapChannelOffset="4" numDensityMapChannels="1" materialId="99005" distanceMapIds="99985" cellSize="8" viewDistance="80" objectMask="16711935"  distanceMapLayers="1" decalLayer="0" atlasSize="1"  atlasOffsets="1 0" numBlocksPerUnitDefault="1.2" numBlocksPerUnitMin="1.2" numBlocksPerUnitMax="1.2" width="1.5" height="0.5" widthVariance="0" heightVariance="0" horizontalPositionVariance="0.1" blockShapeId="!!HAULMBLOCKSHAPEID!!"/>
    </FoliageMultiLayer>


#######################
Anleitung Teil 5 von 5:

Kopiere den ORDNER 'choppedStraw_SDK' in das Verzeichnis [mapName/maps].



#######################
Abschließend sollte die Map einmal im Giants Editor geöffnet werden. Im Fenster "Scripting" werden eventuelle Fehler angezeigt. Solange diese vorhanden sind, die Map NICHT im Giants Editor abspeichern. Behebe erst alle Probleme im Texteditor.
Bei Fehlerfreiheit die Map einmal im Giants Editor abspeichern.

#######################
Fehlersuche:

Sollte im Spiel kein Stroh erscheinen, ist als erstes die log.txt zu prüfen. Bei korrekt installiertem choppedStraw findet man drei Einträge:

  *** ChoppedStraw fruittypes registered!
  *** ChoppedStraw v15.x.xx specialization loading ***

Fehlt der erste Eintrag, wird die fruits.lua nicht gefunden. Prüfe Anleitung Teil 6 & 7!
Fehlt der zweite Eintrag, stimmt etwas mit ZZZ_ChoppedStraw.zip nicht. Prüfe Anleitung Teil 7!
